[gd_scene load_steps=31 format=3 uid="uid://cfgadybufkebx"]

[ext_resource type="Script" path="res://addons/zylann.hterrain/hterrain.gd" id="3_ledq5"]
[ext_resource type="PackedScene" uid="uid://cay0caj5ph44c" path="res://Scenes/player.tscn" id="3_nqt66"]
[ext_resource type="AudioStream" uid="uid://bv1ok8cdly4jg" path="res://Audio/Player/UI.wav" id="3_xko2i"]
[ext_resource type="AudioStream" uid="uid://neemhyqud4ly" path="res://Audio/Ambience/ForestAmbienceDay.wav" id="4_7t5tp"]
[ext_resource type="Script" path="res://addons/zylann.hterrain/hterrain_texture_set.gd" id="5_58vx7"]
[ext_resource type="AudioStream" uid="uid://dyil6tot17sgx" path="res://Audio/Player/FS1.wav" id="5_e6wvn"]
[ext_resource type="Texture2D" uid="uid://xtany0akt6l3" path="res://Ground/slot0_albedo_bump.png" id="5_lkvfm"]
[ext_resource type="Texture2D" uid="uid://d2fuv6kv6tgv8" path="res://Ground/slot0_normal_roughness.png" id="6_00ia3"]
[ext_resource type="AudioStream" uid="uid://cod04wxuwhm2o" path="res://Audio/Pig/Pig.wav" id="6_26kup"]
[ext_resource type="AudioStream" uid="uid://cyr2khkm4pk2o" path="res://Audio/Player/FS2.wav" id="6_c48tw"]
[ext_resource type="AudioStream" uid="uid://becy63cw88utw" path="res://Audio/Player/FS3.wav" id="7_b1kkw"]
[ext_resource type="Script" path="res://Scripts/Pig.gd" id="7_ehxkd"]
[ext_resource type="Script" path="res://Scripts/UI/pause.gd" id="8_7so06"]
[ext_resource type="AudioStream" uid="uid://b2hh0twn4y3u5" path="res://Audio/Player/Truffle1.wav" id="8_lveoo"]
[ext_resource type="Script" path="res://Scripts/UI/settings.gd" id="9_syncu"]
[ext_resource type="Script" path="res://Scripts/truffle.gd" id="10_j3y87"]
[ext_resource type="Resource" path="res://HTerrain2/data.hterrain" id="12_7of0u"]
[ext_resource type="Texture2D" uid="uid://bwhh3okgd7pg6" path="res://Graphics/Textures/d83j68z-4a876f53-caf6-4769-8632-636c7cba15cc.jpg" id="18_ti12d"]
[ext_resource type="Script" path="res://Scenes/entertower.gd" id="19_42075"]
[ext_resource type="AudioStream" uid="uid://0hnhke05aohy" path="res://Audio/Player/untitled.wav" id="20_dd45u"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_i6qpr"]

[sub_resource type="Sky" id="Sky_p6ga0"]
sky_material = SubResource("ProceduralSkyMaterial_i6qpr")

[sub_resource type="Environment" id="Environment_gi00v"]
background_mode = 2
sky = SubResource("Sky_p6ga0")

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_065pp"]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_rt43k"]

[sub_resource type="SphereShape3D" id="SphereShape3D_ugj1v"]
radius = 22.0

[sub_resource type="SphereShape3D" id="SphereShape3D_c8npn"]
radius = 2.90831

[sub_resource type="NavigationMesh" id="NavigationMesh_cxmb2"]
vertices = PackedVector3Array(-126.213, 0.4603, -136.98, -126.213, 0.4603, 127.77, 127.787, 0.4603, 127.77, 127.787, 0.4603, -136.98)
polygons = [PackedInt32Array(3, 2, 0), PackedInt32Array(0, 2, 1)]

[sub_resource type="Resource" id="Resource_avr48"]
script = ExtResource("5_58vx7")
mode = 0
textures = [[ExtResource("5_lkvfm")], [ExtResource("6_00ia3")]]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_72xkf"]
albedo_color = Color(0.644663, 0.644663, 0.644663, 1)
albedo_texture = ExtResource("18_ti12d")

[node name="World2" type="Node3D"]

[node name="PauseMenu" type="CanvasLayer" parent="."]
visible = false

[node name="Pause" type="MarginContainer" parent="PauseMenu"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -100.5
offset_top = -109.5
offset_right = 100.5
offset_bottom = 109.5
grow_horizontal = 2
grow_vertical = 2
scale = Vector2(1.32, 1)
script = ExtResource("8_7so06")

[node name="menu" type="VBoxContainer" parent="PauseMenu/Pause"]
layout_mode = 2

[node name="Resume" type="Button" parent="PauseMenu/Pause/menu"]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Resume
"

[node name="Setting" type="Button" parent="PauseMenu/Pause/menu"]
layout_mode = 2
theme_override_font_sizes/font_size = 45
text = "Settings"

[node name="Quit" type="Button" parent="PauseMenu/Pause/menu"]
layout_mode = 2
theme_override_font_sizes/font_size = 40
text = "Quit"

[node name="settings" type="VBoxContainer" parent="PauseMenu/Pause"]
visible = false
layout_mode = 2
script = ExtResource("9_syncu")

[node name="Back" type="Button" parent="PauseMenu/Pause/settings"]
layout_mode = 2
theme_override_font_sizes/font_size = 35
text = "Back"

[node name="Resolutions" type="OptionButton" parent="PauseMenu/Pause/settings"]
layout_mode = 2
item_count = 3
popup/item_0/text = "1920x1080"
popup/item_1/text = "1600x900"
popup/item_1/id = 2
popup/item_2/text = "1152x648"
popup/item_2/id = 1

[node name="Volume" type="HSlider" parent="PauseMenu/Pause/settings"]
layout_mode = 2
value = 80.0

[node name="Label" type="Label" parent="PauseMenu/Pause/settings/Volume"]
layout_mode = 2
offset_left = -58.3333
offset_top = -4.5
offset_right = 125.667
offset_bottom = 18.5
text = "Volume"

[node name="Mute" type="CheckBox" parent="PauseMenu/Pause/settings/Volume"]
layout_mode = 2
offset_left = -57.5757
offset_top = 18.5
offset_right = 126.424
offset_bottom = 49.5
text = "Mute"

[node name="AudioStreamPlayer2D" type="AudioStreamPlayer2D" parent="PauseMenu"]
stream = ExtResource("3_xko2i")
volume_db = 5.0

[node name="Env" type="Node3D" parent="."]

[node name="WorldEnvironment" type="WorldEnvironment" parent="Env"]
environment = SubResource("Environment_gi00v")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Env"]
transform = Transform3D(-0.311633, -0.939428, -0.14269, -0.868053, 0.220384, 0.444877, -0.386483, 0.262501, -0.884152, -77.4578, 81.6063, -17.7329)
shadow_enabled = true

[node name="DayAudio" type="AudioStreamPlayer" parent="Env"]
stream = ExtResource("4_7t5tp")
autoplay = true

[node name="NightAudio" type="AudioStreamPlayer" parent="Env"]

[node name="Player" parent="." instance=ExtResource("3_nqt66")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -13.162, 0.891049, -2.90081)
current_speed = 3.0
walk_speed = 3.0
run_speed = 5.0
footstep_sounds = Array[AudioStream]([ExtResource("5_e6wvn"), ExtResource("6_c48tw"), ExtResource("7_b1kkw")])

[node name="FootstepPlayer" type="AudioStreamPlayer3D" parent="Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.563287, 0)
volume_db = -27.0
max_distance = 1.5

[node name="Pig" type="Node3D" parent="."]
transform = Transform3D(-0.597219, 0, 0.802078, 0, 1, 0, -0.802078, 0, -0.597219, -20.8979, 0.4002, -0.0534172)

[node name="CharacterBody3D" type="CharacterBody3D" parent="Pig" node_paths=PackedStringArray("waypoints")]
script = ExtResource("7_ehxkd")
waypoints = [NodePath("../../Marker3D")]
footstep_sounds = Array[AudioStream]([ExtResource("5_e6wvn"), ExtResource("6_c48tw"), ExtResource("7_b1kkw")])

[node name="CollisionShape3D" type="CollisionShape3D" parent="Pig/CharacterBody3D"]
transform = Transform3D(1, 0, 0, 0, 0.429968, 0, 0, 0, 1, 0, 0, 0)
shape = SubResource("CapsuleShape3D_065pp")

[node name="MeshInstance3D" type="MeshInstance3D" parent="Pig/CharacterBody3D/CollisionShape3D"]
mesh = SubResource("CapsuleMesh_rt43k")
skeleton = NodePath("../..")

[node name="MeshInstance3D2" type="MeshInstance3D" parent="Pig/CharacterBody3D/CollisionShape3D"]
transform = Transform3D(-0.135714, 0, -0.627444, 0, 0.537912, 0, 0.948241, 0, -0.0898016, 0.0133724, 0.116302, -0.231405)
mesh = SubResource("CapsuleMesh_rt43k")
skeleton = NodePath("../..")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="Pig/CharacterBody3D"]

[node name="Timer" type="Timer" parent="Pig/CharacterBody3D"]
wait_time = 0.5
one_shot = true

[node name="PlayerLeave" type="Area3D" parent="Pig/CharacterBody3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Pig/CharacterBody3D/PlayerLeave"]
shape = SubResource("SphereShape3D_ugj1v")

[node name="PlayerEnter" type="Area3D" parent="Pig/CharacterBody3D"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Pig/CharacterBody3D/PlayerEnter"]
shape = SubResource("SphereShape3D_c8npn")

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="Pig/CharacterBody3D"]
stream = ExtResource("6_26kup")
autoplay = true
max_distance = 10.0

[node name="PigFootstepPlayer" type="AudioStreamPlayer3D" parent="Pig/CharacterBody3D"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.259255, 0)
volume_db = -18.0
max_distance = 30.0

[node name="Dig" type="Timer" parent="Pig"]

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_cxmb2")

[node name="Stage" type="Node3D" parent="NavigationRegion3D"]

[node name="HTerrain" type="Node3D" parent="NavigationRegion3D/Stage"]
script = ExtResource("3_ledq5")
centered = true
_terrain_data = ExtResource("12_7of0u")
chunk_size = 32
collision_enabled = true
collision_layer = 1
collision_mask = 1
shader_type = "Classic4Lite"
custom_shader = null
custom_globalmap_shader = null
texture_set = SubResource("Resource_avr48")
render_layers = 1
cast_shadow = 1
shader_params/u_ground_uv_scale = 20
shader_params/u_depth_blending = true
shader_params/u_triplanar = null
shader_params/u_tile_reduction = Vector4(1, 1, 1, 1)

[node name="CSGBox3D" type="CSGBox3D" parent="NavigationRegion3D/Stage"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.847412, -0.5397, -4.55255)
visible = false
size = Vector3(255.12, 1, 265.854)

[node name="Marker3D" type="Marker3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -18.8497, 0, -22.3385)

[node name="CSGBox3D" type="CSGBox3D" parent="Marker3D"]

[node name="Truffle" type="CSGBox3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -17.5019, 0.0721631, -9.76532)
use_collision = true
size = Vector3(1, 0.471436, 1)
script = ExtResource("10_j3y87")

[node name="TrufflePickUp" type="AudioStreamPlayer3D" parent="Truffle"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 7.45058e-09, 0)
stream = ExtResource("8_lveoo")
volume_db = -7.0

[node name="Trees" type="Node3D" parent="."]

[node name="Door" type="CSGBox3D" parent="."]
transform = Transform3D(-0.0111694, -0.999929, -0.00434102, 0.000758856, 0.00433279, -0.99999, 0.999937, -0.0111732, 0.000710398, 4.82078, 1.97917, 2.79173)
visible = false
use_collision = true
size = Vector3(0.162475, 1.4465, 3.07932)
material = SubResource("StandardMaterial3D_72xkf")
script = ExtResource("19_42075")

[node name="AudioStreamPlayer3D" type="AudioStreamPlayer3D" parent="Door"]
stream = ExtResource("20_dd45u")
pitch_scale = 0.66
autoplay = true

[connection signal="pressed" from="PauseMenu/Pause/menu/Resume" to="PauseMenu/Pause" method="_on_resume_pressed"]
[connection signal="pressed" from="PauseMenu/Pause/menu/Setting" to="PauseMenu/Pause" method="_on_setting_pressed"]
[connection signal="pressed" from="PauseMenu/Pause/menu/Quit" to="PauseMenu/Pause" method="_on_quit_pressed"]
[connection signal="pressed" from="PauseMenu/Pause/settings/Back" to="PauseMenu/Pause" method="_on_back_pressed"]
[connection signal="item_selected" from="PauseMenu/Pause/settings/Resolutions" to="PauseMenu/Pause/settings" method="_on_resolutions_item_selected"]
[connection signal="value_changed" from="PauseMenu/Pause/settings/Volume" to="PauseMenu/Pause/settings" method="_on_volume_value_changed"]
[connection signal="toggled" from="PauseMenu/Pause/settings/Volume/Mute" to="PauseMenu/Pause/settings" method="_on_mute_toggled"]
[connection signal="timeout" from="Pig/CharacterBody3D/Timer" to="Pig/CharacterBody3D" method="_on_timer_timeout"]
[connection signal="body_entered" from="Pig/CharacterBody3D/PlayerLeave" to="Pig/CharacterBody3D" method="_on_player_leave_body_entered"]
[connection signal="body_exited" from="Pig/CharacterBody3D/PlayerLeave" to="Pig/CharacterBody3D" method="_on_player_leave_body_exited"]
[connection signal="body_entered" from="Pig/CharacterBody3D/PlayerEnter" to="Pig/CharacterBody3D" method="_on_player_enter_body_entered"]
[connection signal="timeout" from="Pig/Dig" to="Pig/CharacterBody3D" method="_on_dig_timeout"]
